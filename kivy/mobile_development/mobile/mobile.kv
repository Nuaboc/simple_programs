#:kivy 2.0.0

#:import FadeTransition kivy.uix.screenmanager.FadeTransition
#:import NoTransition kivy.uix.screenmanager.NoTransition
#:import SlideTransition kivy.uix.screenmanager.SlideTransition


# Root is the root widget (a child class from Screen Manager)
Root:
    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
    #transition: FadeTransition()
    OpeningScreen:
    MainScreen:
    SettingsScreen:
    AboutScreen:


<OpeningScreen>:
    name: 'opening'
    # Setting the screen as a FloatLayout allows to set each child widget in a relative position.
    FloatLayout
        # Create a text 'widget' to be rendered.
        Label:
            text: 'Super App!'
            font_size: 70
            color: 0, 0, 0, 1
            pos_hint: {'top': 1.25}
        Label:
            text: 'Daily tip!!!'
            font_size: 20
            color: 0, 0, 0, 1
            pos_hint: {'top': 1}
        Label:
            text: 'Tap anywhere to continue'
            color: 0, 0, 0, .5
            pos_hint: {'bottom': 2}
            pos_hint: {'top': .75}
        Button:
            # set the background transparent
            background_color: 0, 0, 0, 0
            # Set the button size same as screen so wherever the user tap or click set the on_press binding
            size_hint: root.size
            pos: root.pos
            # Tells the ScreenManager to change the current screen to 'main'
            on_release:
                root.manager.transition = NoTransition()
                app.root.current = 'main'



<Label>
    font_size: 25
    color: 0, 0, 0, 1


<PopUpContent>
    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        pos_hint: {'top': 1, 'right': 1}
        #pos: 100, 100
        orientation: 'vertical'
        Label:
            text: "Coding is fun!"


<MainScreen>:
    name: 'main'
    test_var: testing_var
    test_var2: testing_var2

    FloatLayout:
        Label:
            pos_hint: {'top': 1.40}
            text: 'Main Screen!'
            font_size: 30
            color: 0, 0, 0, 1
        Button:
            background_normal: 'icon.png'
            #background_down: 'down.png'
            border: 0,0,0,0
            # Make the background of the button invisible
            #background_color: 0, 0, 0, 0
            size_hint: None, None
            size: 100, 100
            pos_hint: {'top': .95, 'right': .95}
            # make the text visible
            color: 0, 0, 0, 1
            font_size: 30
            on_release:
                root.manager.transition = SlideTransition()
                app.root.current = 'settings'

        BoxLayout:
            orientation: 'vertical'
            pos_hint: {'top': .75}
            size_hint: 1, None

            GridLayout:
                row_force_default: True
                # Set the row height to 100 px
                row_default_height: 100
                cols: 3
                size_hint: 1, None
                canvas:
                    Color:
                        rgba: .5, .5, .5, .4
                    Rectangle:
                        size: self.size
                        pos: self.pos
                # Column titles
                Label:
                    text: 'A'
                Label:
                    text: 'B'
                Label:
                    text: 'C'

            # Here a gridlayout representing a table
            GridLayout:
                size_hint: 1, None
                cols: 3
                row_force_default: True
                # Set the row height to 100 px
                row_default_height: 100
                canvas:
                    Color:
                        rgba: .5, .5, .5, .25
                    # Make a rectangle to render the canvas color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                # The 'slot1' is an input 'box'
                TextInput:
                    id: testing_var

                    # Set the input text box background to transparent
                    background_color: 0, 0, 0, 0
                    font_size: 25
                    text: 'default'
                    multiline: False
                    on_text_validate: root.press()
                Label:
                    text: 'slot 2'
                Label:
                    text: 'slot 3'
                TextInput:
                    text: 'A2'
                    multiline: False
                Label:
                    text: 'slot 5'
                Label:
                    text: 'slot 6'
                Label:
                    text: 'A3'
                Label:
                    text: root.test_var.text  # slot 8
                TextInput:
                    id: testing_var2  # slot 9
                    multiline: False
                Label:
                    text: root.test_var2.text  # slot 10
                Label:
                    text: 'slot 11'
                Button:
                    text: 'Show PopUp window'  # slot 12
                    on_release: root.p.open()

        Button:
            size_hint: 1, .25
            pos_hint: {'top': .25, 'right': 1}
            text: 'push'
            color: 0, 1, 1, 1
            on_release: root.show_keyboard()


<ColourScreen>:
    name: 'color'
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'colour {:.2},{:.2},{:.2} screen'.format(*root.colour[:3])
            font_size: 30
            color: 0, 0, 0, 1
        Widget:
            canvas:
                Color:
                    rgba: root.colour
                Ellipse:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            orientation: 'vertical'
            Button:
                text: 'go back to settings'
                font_size: 30
                on_release:
                    root.manager.transition = SlideTransition(direction="right")
                    app.root.current = 'settings'
            Button:
                id: btn
                text: 'get random colour screen' if btn.state == 'normal' else 'changed'
                font_size: 30
                background_color: [.5,0,.5,.5]
                on_release:
                    root.manager.transition = FadeTransition()
                    app.root.new_colour_screen()


<SettingsScreen>:
    name: 'settings'
    FloatLayout:
        Widget:
            # Set up the background as a full window red rectangle
            canvas:
                Color:
                    rgba: 1, 0, 0, 1
                Rectangle:
                    size: root.size
        Label:
            text: 'Settings'
            font_size: 30
            color: 0, 0, 0, 1
            pos_hint: {'top': 1.4}
        BoxLayout:
            # Set the background of the boxlayout for the button blue with opacity at 20%
            canvas:
                Color:
                    rgba: 1, 1, 1, .2
                Rectangle:
                    size: self.size
                    pos: self.pos
            orientation: 'vertical'
            padding: 15
            pos_hint: {'center_y': .5, 'center_x': .5}
            #pos: self.pos
            size_hint: .5, .3
            #size: self.size
            Button:
                pos_hint: {'center_y': .5, 'center_x': .5}
                size_hint: .8, .1
                background_color: 1, 0, 0, .8
                text: 'go to main screen'
                color: 1, 0, 0, 1
                font_size: 25
                on_release:
                    root.manager.transition.direction = "right"
                    app.root.current = 'main'
            Button:
                pos_hint: {'center_y': .5, 'center_x': .5}
                size_hint: .8, .1
                background_color: 0, 1, 0, .8
                text: 'get random colour screen'
                color: 0, 1, 0, 1
                font_size: 25
                on_release:
                    root.manager.transition.direction = "left"
                    app.root.new_colour_screen()
            Button:
                pos_hint: {'center_y': .5, 'center_x': .5}
                size_hint: .8, .1
                background_color: 0, 0, 1, .7
                text: 'About'
                color: 0, 0, 1, 1
                font_size: 25
                on_release:
                    root.manager.transition.direction = "left"
                    app.root.current = 'about'


<AboutScreen>
    name: 'about'
    FloatLayout:
        Label:
            text: 'About'
            font_size: 100
            pos_hint: {'center_x': 0.5, 'center_y': .75}

        Button:
            text: 'back'
            font_size: 50
            pos_hint: {'center_x': 0.5, 'center_y': 0.25}
            size_hint: .5, .25
            on_release:
                root.manager.transition.direction = "right"
                app.root.current = 'settings'